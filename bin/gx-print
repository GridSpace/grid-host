#!/bin/bash

host=${1}
port=${2}
filein=${3}
fileout=${4}
time=${5:-100}
length=${6:-100}
filename=${7:-noname.gx}
image=${8:-bin/km.bmp}

usage() {
    echo "usage: gx-print [host] [port] [filein] [fileout] <time> <length> <name> <image>"
    exit
}

[ -z ${host} ] || [ -z ${port} ] || [ -z ${filein} ] || [ -z ${fileout} ] && usage

(
    date
    echo "host:${host} port:${port} in:${filein} out:${fileout} time:${time} length:${length} filename:${filename} image:${image}"
    node bin/util-gx.js make "${fileout}" "${filein}" "${image}" "${time}" "${length}"
    node bin/util-gx.js send "${fileout}" "${host}" "${port}" "${filename}"
) >> /tmp/gx-print.log 2>&1
