#!/bin/bash

host=${1}
port=${2}
file=${3}
time=${4:-100}
length=${5:-100}
name=${6:-noname.gx}
image=${7:-bin/km.bmp}

fileout="${file}.out"

usage() {
    echo "usage: gx-print [host] [port] [file] <time> <length> <name> <image>"
    exit
}

[ -z ${host} ] || [ -z ${port} ] || [ -z ${file} ] && usage

(
    date
    echo "gx-print ${host} ${port} ${file} ${time} ${length} ${name} ${image}"
    node bin/gx-util.js make "${fileout}" "${file}" "${image}" "${time}" "${length}"
    node bin/gx-util.js send "${fileout}" "${host}" "${port}" "${name}"
    echo "cleanup tmp ${fileout}" && rm -f "${fileout}"
) # >> /tmp/gx-print.log 2>&1
